---
layout: hidden_page
title: 斐波那契数列学习笔记
---

* auto-gen TOC:
{:toc}
# 斐波那契数列

令$F(1)=F(2)=1$，斐波那契数列的第$i$项为$F(i)=F(i-1)+F(i-2)$



## 前置知识

二次剩余

等比数列求和公式: $\large S_n=a_1\frac{1-q^n}{1-q}=\frac{a_1-a_nq}{1-q}\ (q\ne 1)$



## 通项公式

$$\large{F_{n}=\frac{1}{\sqrt{5}}\left[\left(\frac{1+\sqrt{5}}{2}\right)^{n}-\left(\frac{1-\sqrt{5}}{2}\right)^{n}\right]}$$

通项求解过程见参考资料。



### 狠人解法

由递推公式可知
$$
\begin{pmatrix}
F_n \\ F_{n+1}
\end{pmatrix}
=\begin{pmatrix}
 0 & 1 \\
 1 & 1
\end{pmatrix}
\begin{pmatrix}
F_{n-1} \\ F_{n}
\end{pmatrix}
$$
对角化得
$$
\begin{pmatrix}
 0 & 1 \\
 1 & 1
\end{pmatrix}
=
\left(\begin{array}{cc}
-1+\sqrt{5} & -1-\sqrt{5} \\
2 & 2
\end{array}\right)\left(\begin{array}{cc}
\frac{1+\sqrt{5}}{2} & 0 \\
0 & \frac{1-\sqrt{5}}{2}
\end{array}\right)\left(\begin{array}{cc}
\frac{1}{2 \sqrt{5}} & \frac{1+\sqrt{5}}{4 \sqrt{5}} \\
-\frac{1}{2 \sqrt{5}} & \frac{-1+\sqrt{5}}{4 \sqrt{5}}
\end{array}\right)
$$

因此

$$
F_n=
\begin{pmatrix}
 1 & 0
\end{pmatrix}
\left(\begin{array}{cc}
-1+\sqrt{5} & -1-\sqrt{5} \\
2 & 2
\end{array}\right)\left(\begin{array}{cc}
(\frac{1+\sqrt{5}}{2})^n & 0 \\
0 & (\frac{1-\sqrt{5}}{2})^n
\end{array}\right)
\left(\begin{array}{cc}
\frac{1}{2 \sqrt{5}} & \frac{1+\sqrt{5}}{4 \sqrt{5}} \\
-\frac{1}{2 \sqrt{5}} & \frac{-1+\sqrt{5}}{4 \sqrt{5}}
\end{array}\right)
\begin{pmatrix}
0 \\ 1
\end{pmatrix}
$$

计算得

$$
\begin{align}
F_n&=
\begin{pmatrix}
 -1+\sqrt{5} & -1-\sqrt{5}
\end{pmatrix}
\begin{pmatrix}
(\frac{1+\sqrt{5}}{2})^n  & 0 \\
 0 & (\frac{1-\sqrt{5}}{2})^n
\end{pmatrix}
\begin{pmatrix}
\frac{1+\sqrt{5}}{4\sqrt{5}} \\
\frac{\sqrt{5}-1}{4\sqrt{5}}
\end{pmatrix}\\
&=\frac{(\frac{1+\sqrt{5}}{2})^n-(\frac{1-\sqrt{5}}{2})^n}{\sqrt{5}}

\end{align}
$$



#### 推广

假设特征方程无重根，



### 巧妙解法





## Fibonacci数列的幂和

给定$n,k$，求$S=(F_1^k+F_2^k+\cdots F_n^k)\mod {(10^9+7)}$



# 附

## 拓展问题1：

若$F(i)=F(i-1)+F(i-2)+F(i-3)$，$F(1)=F(2)=F(2)=1$，求$F(i)$的通项公式.





# 参考

-   [斐波那契数列的通项公式推导-任所怀](http://old.pep.com.cn/gzsx/xszx_1/jtzd/201107/t20110708_1054105.htm)
-   斐波那契数列通项公式是怎样推导出来的？ - Lancewu的回答 - 知乎 https://www.zhihu.com/question/25217301/answer/580609745
-   斐波那契数列通项公式是怎样推导出来的？ - 面无表情的仔仔的回答 - 知乎 https://www.zhihu.com/question/25217301/answer/158291644
-   差分方程的求解 https://wenku.baidu.com/view/c9fdb47f6ad97f192279168884868762cbaebb08.html

