---
layout: hidden_page
title: 本原勾股数组学习笔记
---

* auto-gen TOC:
{:toc}
# 参考资料

[走进数论——神奇的勾股数组](https://www.luogu.com.cn/blog/lhc/TheStoryOfPythagoreanTriples)

[【数论】本原勾股数组(PPT)的性质](https://www.cnblogs.com/yhyxy/p/11333686.html)




# 前置知识

[高斯整数](/post/category/数论/高斯整数.html)（推荐）




# 定义与性质

对于$a^2+b^2=c^2$，且$gcd(a,b,c)=1$，其中$a,b$定为一奇一偶，$c$为奇数，我们约定$a$为奇数，$b$为偶数

每个勾股数组$(a, b, c)$，都可以由以下公式得出

$s^2=c+b,\ t^2=c-b$

该三角形的周长$C=s(s+t)$

$a=st, b=\frac{s^2-t^2}{2}, c=\frac{s^2+t^2}{2}\ (s>t\ge0)$

$s,t$是任意没有公因数的奇数

### 证明

下面证明$s,t$是互素的奇数



设$gcd(s, t)=d$

即$d|s$且$d|t$

则$d|(s+t)$且$d|(s-t)$，即$d|2c$且$d|2b$

由于$s\%2=1$，因此$d$不可能为2的倍数

因此$d|b$且$d|c$

有因为$d^2|a^2$，即$d|a$

因此$d|gcd(a,b,c)$



上面的数学公式可能无法正常渲染，这里贴图

![](https://blog.chgtaxihe.top/resource/img/post/pythagorean_array_1.PNG)

根据本源勾股数组的定义，$d=1$



## 其他性质

$(a,b,c)$中$a,b$有且仅有一个是3的倍数，$c$不是3的倍数

$(a,b,c)$中有且只有一个为5的倍数



# 例题

## [51nod 1165](https://vjudge.net/problem/51Nod-1165)

由于周长$C=s(s+t)$，且$N\le1e7$，那么我们可以遍历$s$，可知$s<sqrt(1e7)$，求出所有本原直角三角形

AC代码如下（关闭流同步后，耗时:375ms）

```c++
#include <bits/stdc++.h>
#define ll long long

using namespace std;

const int maxn = 1e7 + 100;
int ans[maxn]={0}, t, n;

int main(){
    ll limit = sqrt(maxn)+1, cir;
    for(int s=3; s<=limit; s+=2){ // s为奇数
        for(int t=1; t<s; t+=2){ // t为奇数
            if(__gcd(s, t) != 1) continue;
            cir = s*(s+t);
            for(int k=1; k*cir<maxn; k++) ans[k*cir]++; // 计算贡献
        }
    }
    cin >> t;
    while(t--) {
        cin >> n;
        cout << ans[n] << '\n';
    }
}
```



