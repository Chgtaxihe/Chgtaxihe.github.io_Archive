---
layout: hidden_page
title: 树状数组学习笔记
---

* auto-gen TOC:
{:toc}


# 树状数组求前缀和

待补充



# 树状数组求区间最值

## 例题[洛谷P3865](https://www.luogu.com.cn/problem/P3865)

ST表的模板题，肯定不能用ST做啦~

ST表(1.22s，8.51M)，树状数组（1.29s，6.9M），耗时差不多，但内存占用少了

```c++
#include <bits/stdc++.h>
#define Android ios::sync_with_stdio(false), cin.tie(NULL)

using namespace std;

const int maxn = 1e6 + 100;

int bit[maxn] = {0}, val[maxn];

void update(int x, int pos, int n){
    while(pos <= n){
        bit[pos] = max(bit[pos], x);
        pos += (-pos) & pos;
    }
}

int query(int l, int r){ // 结果包含左/右端点
    int ans = val[r], tmp;
    while(l <= r){
        tmp = r - (r & (-r));
        if(tmp >= l){
            ans = max(ans, bit[r]);
            r = tmp;
        }else{
            ans = max(ans, val[r--]); // 当减去lowbit后小于l时，同原数组对比
        }
    }
    return ans;
}

void solve(){
    int n, m;
    cin >> n >> m;
    for(int i=1; i<=n; i++) {
        cin >> val[i];
        update(val[i], i, n);
    }
    for(int i=0, l, r; i<m; i++){
        cin >> l >> r;
        cout << query(l, r) << '\n';
    }
}

signed main(){
    Android;
    solve();
}
```

